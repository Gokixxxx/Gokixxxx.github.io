<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>生成函数入门</title>

        <link rel="stylesheet" href="dist/reset.css">
        <link rel="stylesheet" href="dist/reveal.css">
        <link rel="stylesheet" href="dist/theme/black-modified.css">

        <!-- Theme used for syntax highlighted code -->
        <link rel="stylesheet" href="plugin/highlight/monokai.css">
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section data-transition="slide">
                    <h1>生成函数出门</h1>
                    <p>Qiu Yucheng, Unnamed No.84 High School</p>
                </section>
                <section data-transition="slide">
                    <section data-transition="slide">
                        <h2>胡乱说几句</h2>
                    </section>
                    <section data-transition="slide">
                        <h2>Saying</h2>
                        <p>退役的太突然 俯瞰聚散悲欢——vectorwyx</p>
                    </section>
                    <section data-transition="slide">
                        <h2>什么是生成函数?</h2>
                        <p class="fragment">请学习 生成函数入门。</p>
                    </section>
                    <section data-transition="slide">
                        <h2>禁止使用生成函数</h2>
                        <p class="fragment">在cts以下的ccf组织的赛事中大概不会出现法法塔，所以那些$O(n\log n)$的法题我们只需要爆力做到$O(n^2)$就好了。</p>
                        <p class="fragment">很遗憾，今天默认你会多项式全家桶。</p>
                    </section>
                    <section data-transition="slide">
                        <h2>一个小问题</h2>
                        <p class="fragment">课件的很多地方只留了一个空白。</p>
                    </section>
                </section>
                <section data-transition="slide">
                    <section data-transition="slide">
                        <h2>线性递推</h2>
                    </section>
                    <section data-transition="slide">
                        <h3>经典题</h3>
                        <p class="fragment">有$m$种硬币，面值和$\leq 10^3$，每种硬币有一个个数，求凑出面值$n$的方案数。$n\leq 10^{18}$。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>那么应该怎么算线性递推呢?</h3>
                    </section>
                    <section data-transition="slide">
                        <h3>部分分式</h3>
                    </section>
                </section>
                <section data-transition="slide">
                    <section data-transition="slide">
                        <h2>d-finite，整式递推</h2>
                    </section>
                    <section data-transition="slide">
                        <h3>顺子</h3>
                        <p class="fragment">求有多少个长$n$的排列不包含长$m$的连续上升/下降段，也就是形如$x,x+1,...,x+k$或$x,x-1,...,x-k$的段。$n,m\leq 10^7$。</p>
                        <p class="fragment">2021年山东省队胡策 qwaszx round。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>ode自动机</h3>
                    </section>
                    <section data-transition="slide">
                        <h3>错排</h3>
                        <p class="fragment">多次给出$n,m$，求有多少个长$n$的排列满足对于$i>m$有$p_i\neq i$。$n,m\leq 10^5$。</p>
                        <p class="fragment">gdkoi 2023。</p>
                    </section>
                </section>
                    <section data-transition="slide">
                        <h2>拉格朗日反演</h2>
                        <p class="fragment">如果$F,G$互为复合逆，且$F,G$都没有常数项，都有一次项，那么</p>
                        <p class="fragment">$\displaystyle[z^n]H(F)=\frac{1}{n}[z^{n-1}]H^\prime\left(\frac{z}{G}\right)^n$</p>
                        <p class="fragment">或者</p>
                        <p class="fragment">$\displaystyle[z^n]H(F)=[z^n]HG^\prime\left(\frac{z}{G}\right)^{n+1}$</p>
                        <p class="fragment">用来在原幂级数(或它的复合方程)和它的复合逆之间相互转化。可以注意到如果$F$没有常数项且有一次项，那么$G$也必然没有常数项且有一次项，而且$G$必然是个幂级数(没有负次项)。感觉这个挺对的啊。</p>
                        <p class="fragment">这两个式子选择哪一个的话，如果需要求常数项则只能选第二个，否则就看$H,G$哪个比较容易求导。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>大朋友和多叉树</h3>
                        <p class="fragment">如果一个点有$c$个儿子，那么它的权值是$a_c$，保证$a_0=1,a_1=0$。求所有$n$个叶子的树的权值和，认为儿子之间有序，但树无标号。$n\leq 10^5$。</p>
                        <p class="fragment">认为$a_0=0$，这给出复合方程$F=A(F)+z$，也就是说$F$的复合逆是$z-A$，拉格朗日反演，多项式快速幂即可。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>广义二项级数</h3>
                        <p class="fragment">定义广义二项级数为$\mathcal B_t=1+z\mathcal B_t^t$，求$[z^n]\mathcal B_t^r$的一个封闭形式。</p>
                        <p class="fragment">转而考虑$\mathcal B_t-1$对吧，那么$\frac{\mathcal B_t-1}{(\mathcal B_t-1+1)^t}=z$，也就是说它的复合逆是$\frac{z}{(1+z)^t}$。这里$H=(1+z)^r$，使用拉格朗日反演</p>
                        <p class="fragment">$\displaystyle[z^n]\mathcal B_t^r=\frac{1}{n}[z^{n-1}]r(1+z)^{tn+r-1}=\frac{r}{n}\binom{tn+r-1}{n-1}$</p>
                       <p class="fragment">通过吸收可以知道它就是$\frac{r}{tn+r}\binom{tn+r}{n}$。</p>
                    </section>
                </section>
                <section data-transition="slide">
                    <section data-transition="slide">
                        <h2>牛顿迭代</h2>
                        <p class="fragment">一般来说用于求解多项式方程，但是也有一些奇妙用法。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>另一个欧拉数问题</h3>
                        <p class="fragment">求$\frac{1}{(1-z)^a}$的复合逆。$n\leq 10^5$。</p>
                        <p class="fragment">泰勒展开之。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>烷基计数</h3>
                        <p class="fragment">求解$F(z)=1+\frac{1}{6}z(F(z)^3+3F(z^2)F(z)+2F(z^3))$的前$n$项。$n\leq 10^5$。</p>
                        <p class="fragment">我们要求$F\bmod{z^{2n}}$时，$F(z^2)\bmod{z^{2n}}$是完全已知的，可以当作常多项式。</p>
                    </section>
                </section>
                <section data-transition="slide">
                <section data-transition="slide">
                    <section data-transition="slide">
                        <h2>一些技巧</h2>
                    </section>
                    <section data-transition="slide">
                        <h3>Binomial sum</h3>
                        <p class="fragment">求$\displaystyle\sum_i\binom{n}{i}i^k$。$n\leq 10^9,k\leq 10^6$。</p>
                        <p class="fragment">记$F=(1+z)^n,G=e^z$，那么答案就是$[z^k]F(G)$。对$F$在$1$处泰勒展开，这是因为$G=e^z$的常数项是$1$，这样展开可以让无限和变为有限和。</p>
                        <p class="fragment">这里我们说明了找到一个多项式$\mathcal F$满足$\mathcal F$和$F$在$1$处的$0,...,k$阶导数都相同，那么就可以把$F$换成$\mathcal F$计算，两者的不同在于$F$的次数很大而$\mathcal F$的次数$\leq k$。</p>
                        <p class="fragment">问题是如何求出$\mathcal F$，可以利用其整式递推。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>另一个欧拉数问题</h3>
                        <p class="fragment">给定初值$f(n_0,x)=1$和$\alpha$，有递推式$f(i,j)=(j+1)f(i-1,j)+(\alpha(i-1)-(j-1))f(i-1,j-1)$，求$f(n,m)$。$n\leq 10^5$。这个递推式属于$\alpha$阶欧拉数。</p>
                        <p class="fragment">也就是说$F_i=(1+\alpha(i-1)z)F_{i-1}+z(1-z)F_{i-1}^\prime$。</p>
                        <p class="fragment">猜测存在常多项式$A,B,C$使得$AB^iF_i=C(AB^{i-1}F_{i-1})^\prime=AB^{i-1}CF_{i-1}^\prime+(AB^{i-1})^\prime CF_{i-1}$，可以解出$B=\frac{1}{(1-z)^\alpha},A=\frac{z}{(1-z)^{\alpha+1}},C=\frac{z}{(1-z)^{\alpha-1}}$。</p>
                        <p class="fragment">为什么能猜到$B^i$?先尝试只有$A$的情况，发现出现了一个$\frac{1}{(1-z)^{\alpha(i-1)}}$一类的项，所以猜测有$B^i$一类的项。</p>
                        <p class="fragment">注意到$z\mathrm{D}$性质很好，它只是给$i$次项乘上了$i$，但是$\frac{z}{(1-z)^{\alpha-1}}\mathrm{D}$就很不好。考虑把它变成$z\mathrm{D}$，我们需要使用$C$的复合逆，设它是$G$，代入可以发现它确实完成了这件事。复合$C$是$O(n\log n)$的，所以我们可以牛顿迭代$O(n\log n)$地算出$G$。</p>
                        <p class="fragment">现在要计算$F_n$的一项，先快速幂算出$T_{n_0}(G)$，直接算出$T_n(G)$，然后要复合$C$，拉格朗日反演提取$\frac{T_n}{AB^n}$，$A,B$都可以用$G(C)=z$表示。复杂度$O(n\log n)$。</p>
                    </section>
                    <section data-transition="slide">
                        <h3>转置原理</h3>
                        <p class="fragment">多项式多点求值。</p>
                        <p class="fragment">线性算法是可以表示成矩阵乘向量的算法。如果我们可以对任意$v$快速计算$Av$，那么对这一算法进行转置就可以快速计算$v^TA^T$了。</p>
                        <p class="fragment">考虑多点求值的转置。</p>
                    </section>
                </section>
                <section data-transition="slide">
                    <section data-transition="slide">
                        <h2>如果讲完了的话</h2>
                        <p class="fragment">真没啥了。大家可以翻阅我的blog https://shanlunjiajian.github.io/2023/03/05/counting/ 。</p>
                    </section>
                </section>
                <section data-transition="slide">
                    <section data-transition="slide">
                        <h2>Saying again</h2>
                        <p>退役的太突然 俯瞰聚散悲欢——vectorwyx</p>
                    </section>
                    <section data-transition="slide">
                        <h1>Thanks for Listening!</h1>
                    </section>
                    <section data-transition="slide">
                        <p>Powered by reveal.js</p>
                    </section>
                </section>
            </div>
        </div>

        <script src="dist/reveal.js"></script>
        
        <script src="plugin/markdown/markdown.js"></script>
        <script src="plugin/highlight/highlight.js"></script>
        <script src="plugin/notes/notes.js"></script>
        <script src="plugin/math/math.js"></script>
        <script src="plugin/search/search.js"></script>
        <script src="plugin/zoom/zoom.js"></script>

        <script>
            // More info about initialization & config:
            // - https://revealjs.com/initialization/
            // - https://revealjs.com/config/
            Reveal.initialize({
                hash: true,

                // Learn about plugins: https://revealjs.com/plugins/
                plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath, RevealSearch, RevealZoom ]
            });
        </script>
    </body>
</html>
