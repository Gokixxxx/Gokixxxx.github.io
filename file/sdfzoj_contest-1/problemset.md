<center><h1>csp-j2022模拟赛</h1></center>

<center>sdfz Qyc</center>

本场有恐怖数学题，你可以使用Wolfram Alpha来辅助计算(但是请不要使用oeis，那太没劲了)。

题目难度是按我的感觉升序的，但是你感觉起来可能和我不太一样。反正各位肯定都随手吧（

## A. 生成函数(egf)

1s 256mb。

-----

出多项式题就像贩毒......但是这不是多项式题啊?

给定$$n$$，请你求出

$$
\sum_{i=0}^n\binom{n}{i}f_i
$$

膜$$998244352$$的值。其中斐波那契数$$f_i$$的定义为，$$f_0=0,f_1=1$$，对于$$i\geq 2$$，$$f_i=f_{i-1}+f_{i-2}$$。

每个测试点有$$T$$组数据。$$n\leq 10^{18},T\leq 10000$$。

### 输入格式

第一行一个数$$T$$，接下来$$T$$行，每行一个数$$n$$。

### 输出格式

$$T$$行，每行一个数，表示答案。

### 输入输出样例

#### 输入样例1

```
5
1
2
3
4
5
```

### 输出样例1

```
1
3
8
21
55
```

### 数据范围及约束

本题共有3个测试点，测试点不等分。

对于第一个测试点，$$n\leq 10$$，10分。

对于第二个测试点，$$n\leq 10^6$$，10分。

对于第三个测试点，$$n\leq 10^{18}$$，80分。

对于100%的数据，$$1\leq n\leq 10^{18},T\leq 10000$$。

## B. 爆搜冲了(great_magician)

1.5s 256mb。

-----

搜也要艺术，虽然这个题还不足以称为艺术。

有一个长$$n$$的未知序列$$a$$，你有两个长$$n$$的序列$$x,y$$和三个长$$m$$的序列$$l,r,s$$，求有多少可能的$$a$$满足 : 

 - $$a_i$$是$$[x_i,y_i]$$中的整数。

 - $$a$$在$$[l_i,r_i]$$的和膜$$2$$的结果是$$s_i$$。

答案膜$$10^9+7$$。

$$n\leq 40,x_i\leq y_i\leq 10^9$$。

### 输入格式

第一行两个数$$n,m$$。

接下来$$n$$行，每行两个数$$x_i,y_i$$。

接下来$$m$$行，每行三个数$$l_i,r_i,s_i$$。

### 输出格式

一行一个数，表示答案。

### 输入样例1

```
3 3
1 10
0 21
3 15
2 2 1
3 3 0
2 3 1
```

### 输出样例1

```
660
```

### 数据范围及约束

本题共有10组数据。

对于20%的数据，$$n\leq 20$$。

对于100%的数据，$$1\leq n\leq 40,0\leq m\leq\frac{1}{2}n(n+1),0\leq x_i\leq y_i\leq 10^9,1\leq l_i\leq r_i\leq n,0\leq s_i\leq 1$$。

讲道理这题应该绑subtask的，很可能乱搞就搞过80了......但是这是oi赛制，还是不绑了，另外这是B，搞过就搞过吧（

## C. 观察性质(kang_kang)

1.5s 256mb。

-----

观察性质还是很有趣的!

有一棵树，点有点权$$a_i$$，根是$$1$$。你要从一个起点出发，每一步走到一个祖先，如果你从$$u$$走到$$v$$，那么答案增加$$a_u\operatorname{and}a_v$$。求出从每个点出发的最大答案。$$n\leq 5\times 10^5,a_i\leq 10^{12}$$。

### 输入格式

第一行一个数$$n$$。

接下来一行$$n$$个数，表示各$$a_i$$。

接下来一行$$n-1$$个数，表示点$$2,...,n$$的父亲。

### 输出格式

$$n$$行，每行一个数，表示每个点的答案。

### 输入样例1

```
10
14 9 13 12 6 14 10 4 13 9
1 2 2 4 3 5 7 3 2
```

### 输出样例1

```
0
8
17
16
20
29
24
24
30
17
```

### 数据范围及约束

本题共有20个测试点。

对于前20%的数据，$$n\leq 10^3,a_i\leq 10^5$$。

对于前60%的数据，$$n\leq 10^5,a_i\leq 10^5$$。

对于100%的数据，$$n\leq 5\times 10^5,a_i\leq 10^{12}$$。

## D. 随机算法(no_future)

2s 256mb。

-----

随机算法没有前途。

你写了一个随机算法，当然你也知道它没有前途，但是你还是想算出它有多么没有前途。对于任意一个测试点，它的正确率都是$$p$$，但是你并不知道$$p$$是多少，于是你认为它是一个随机数。现在你已经跑了$$a+b$$个点，其中你过了$$a$$个而wa了$$b$$个，求$$p$$的期望。$$T$$组数据，$$n,m\leq 10^9,T\leq 10^5$$。对于一部分的测试点，你需要输出实数，另一部分你需要输出有理数(可以证明答案确实是有理数)。

你与计算机相比，显然是计算机更擅长计算，你的作用是**观察，猜测和乱搞**。OIer的赞歌是乱搞的赞歌，OIer的伟大是乱搞的伟大!

### 输入格式

第一行两个数$$T,t$$，如果$$t=1$$表示你需要输出实数，$$t=2$$表示输出有理数。

接下来$$T$$行，每行两个数$$a,b$$。

### 输出格式

输出$$T$$行。对于每组数据 : 

 - 如果$$t=1$$，一个实数表示答案，你的答案与标准答案的绝对误差不超过$$10^{-3}$$即判为正确。

 - 如果$$t=2$$，两个整数表示答案约分后的分子和分母。你的答案讲道理必须是精确的，但是由于lemon一个题只能选一个checker，我又不想手写checker，所以如果你输出的不是两个整数而是两个实数，你的答案的分子分母与标准答案的分子分母相对误差或绝对误差**分别**不超过$$10^{-3}$$也判为正确。

### 输入输出样例

#### 输入样例1

```
2 1
1 1000000000
1 1
```

#### 输出样例1

```
0
0.5
```

#### 样例1解释

第一组数据看起来是膜1e9+7的题里面你输出随机数的结果，答案非常接近0，所以输出0是可以得分的。

### 数据范围及约束

本题共有14个测试点，测试点不等分。

对于前6个测试点，$$T=1,t=1,a,b\leq 10$$，每个测试点5分。

对于另外1个测试点，$$T=10^5,t=1,a,b\leq 10^9$$，10分。

对于另外6个测试点，$$T=1,t=2,a,b\leq 10$$，每个测试点5分。

对于另外1个测试点，$$T=10^5,t=2,a,b\leq 10^9$$，30分。

对于100%的数据，$$t=1$$或$$t=2$$，$$a,b\leq 10^9,T\leq 10^5$$。