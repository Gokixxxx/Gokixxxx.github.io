---
layout: post
title: 几个不需要静态top tree的静态top tree问题
subtitle: 咍咍
tags: 数据结构
---

静态top tree，非常好数据结构!

-----

22集训队胡策 R3 B. 举办乘凉州喵，举办乘凉州谢谢喵

大家都会静态top tree做法，就是不停split直到这条链被拆成了$\log$个cluster path，然后直接在此时的收缩树上dfs即可。

我们有一个点分治+重链剖分+长链剖分的1$\log$做法。考虑祖先-后代链咋做，大家都知道轻子树大小和是$n\log n$级别，所以就重链剖分，轻子树的部分预处理一个二维前缀和，这里离线扫链，那么每次更新的是一个前缀的前缀和，所以复杂度很对。但是跳轻边的时候需要加上重子树减去轻子树，这里可以用一个长剖解决，也就是计算子树内距离$\leq k$的点，相当于用总点数减去距离为$k+1$的点的子树大小之和。然后顶上还需要点分一下求子树外的。任意链当然是一样的。

-----

cf1098 F. Ж-function

大家不都会静态top tree做法，所以我们考虑区间和区间的lcp不如后缀和后缀的lcp，相当于求$\sum\limits_{i=l}^r\min(\mathrm{lcp}(i,l),i-r+1)$，所以先建后缀树对吧。

现在你可能会了静态top tree做法，我们对$\min$讨论，$\mathrm{lcp}(i,l)\leq i-r+1$也就是$\mathrm{lcp}(i,l)-i\leq -r+1$，那么就比较的简单了