---
layout: post
title: 群里的趣题
subtitle: just some vegetables
tags: 杂项
---

有个群叫cf vp group，是一些sd的选手，这个选手组织对外的名字大概是Little Vegetable Chickens in ShanDong，你可以查到我们的cf group和vj group(不过vj上叫sdvc)。群里常常有奇怪的问题。

进行了大概的分类。

## 计算几何

### 2021-12-28, from _jhq

给一个三维几何体，它在$$[0,1]\times[0,1]\times[0,1]$$内，并且体积至少是$$\frac{1}{k}$$，其中$$k$$视作常数。它有可能是球，棱柱，棱锥，棱台，圆柱，圆锥，圆台。你每次可以问交互库一个点在不在这个几何体里面，用尽可能少的询问找出它的形状是这七种中的哪一种，保证它确实是其中一种。

给出一个$$O(\log C)$$次查询的做法，其中$$C$$当然是关于精度的常数。不考虑精度问题。

把几何体称为A（

-----

第一眼就可以实现的基本操作 : 

 - 找一个点，$$O(1)$$。做法是随。

 - 从一个点出发放一条射线，找到这个射线与A的交点，$$O(\log C)$$。做法是二分。

 - 给一个A的边界上的点，找到它所在这一段边界切面的方向，$$O(\log C)$$。做法是分别在三个方向上二分。类似地，可以求一个点所在的一条尖锐的棱的方向。

 - 给一个点，判断是不是在A的边界上，$$O(1)$$。做法是直接检查三个方向上$$\pm\epsilon$$的点。

 - 给一个圆面的方向和圆面上一个点，求圆心，$$O(\log C)$$。做法是往两个垂直方向上二分找到圆面的边界上的四个点，然后就直接取中点什么的，总之很能做。

-----

判定球 : 找一个点，往xyz三个方向画线求得球心，随机应该在球上的若干个点，判断是不是真的在球上，也就是它们是不是具有切面。

-----

判定圆柱/锥/台 : 考虑我们找到一个圆面上的一个点P，然后就可以得到圆心，从而检查这是不是圆。考虑如何求这个P，注意到体积至少是$$\frac{1}{k}$$，于是即使高是$$1$$，底面积也得有$$\frac{1}{k}$$，于是半径需要达到$$\frac{1}{\sqrt{\pi k}}$$。画个图可以毛估估一下，从随便一个点随机一个方向，随到底面的概率至少有$$\frac{\arctan(\frac{1}{\sqrt{2\pi k}})}{4\pi}$$，可以自己看一看图（

![img](/img/2021-12-28-vp-group-problems/2021-12-28-jhq.png)

注意因为$$k$$是常数，这个概率不管关于$$k$$是什么级别，它也是常数，所以随$$O(1)$$次，讲道理应该就会有至少一条射线指向底面了。问题是怎么在这些点中找到那个在底面上的。

呃反正只有底面是圆，并且对于圆台，找到两个底面没有什么区别，于是我们只需要都随$$O(1)$$个方向强行检查一下就行了(实际上我想了想只随一个方向就有$$1$$的概率正确)，注意这还是$$O(1)$$次$$O(\log C)$$的操作。然而它有什么实践价值吗（

如果每个点都不行，那么我们可以判定没有圆面，也就是它不是圆柱/锥/台。

然后考虑拿到了底面中心，怎么判断是柱，锥还是台。

 - 从底面中心往垂直方向画射线，如果射到的位置没有切面(或者说在顶点上)那么就是锥。

 - 在离底面边界很近的位置向上画射线，如果射到的位置的切面不和底面平行，那么就是台，否则是柱。

-----

判定棱柱/锥/台 : 这是最后的斗争。

考虑棱柱和棱锥/台的区别在哪里，你发现棱柱每一层的面积是一样的，而棱锥/台每一层都在缩小。同时，棱锥的每个侧面都是三角形，从而棱台的每个侧面都是梯形(并且不可能是平行四边形)。

于是我们只需要找到一个侧面，然后判断它的两条棱是不是平行，如果两条棱平行那就是棱柱，否则我们求出两条棱的交点，如果交点在几何体内那就是棱锥，否则是棱台。

考虑怎么找到一个侧面。直接随!

显然棱柱上直接随是最劣的。考虑它的底面积最多只有$$1$$，于是高至少是$$1/k$$。然后显然这个几何体是正四棱柱，并且你站在中心的时候最劣，然后我们可以放缩成$$\frac{\sqrt{2}}{2}$$距离外有一个高$$\frac{1}{k}$$的环形纸带，射线射到纸带上的概率，容易算出来这是$$\frac{2\arctan(\frac{1}{4\sqrt{2}k})}{\pi}$$，同样的这也是常数。

现在问题是怎么判定一个点是不是在侧面上。注意到侧面必然是个三角形，梯形或者平行四边形，而底面很可能不是其中任何一个，除非它是三棱或者四棱。可能还有别的特殊情况，不过我们先不管，考虑怎么判断一个面是三角形，梯形，四边形，还是什么都不是。

考虑我们随便找到一个边上的点，然后找到这条边的两个端点，然后在端点处，沿着这个面的方向，二分尝试找到下一条边。只需要找三次，如果这三条边还没有和一开始那条边接起来，那么报告不是三角形，梯形或者平行四边形，于是必然是底面。如果它是三角形，梯形或者平行四边形，我们就找出了这个面的形状。

如果它不是三棱也不是四棱，那么随到一个侧面的时候，就可以求出这个几何体的形状。

当然我们需要先特判三棱或者四棱。如果它是三棱或者四棱，那么它的信息很少，我们可以爆力找出它的形状。还是找到一个面，找到面的边界，然后在这些边界的中点处二分来翻到相邻的面。最后

 - 如果有六个面，那么是四棱柱/台

 - 如果有五个面，那么是三棱柱/台/四棱锥

 - 如果有四个面，那么是三棱锥

呃感觉上这个翻过一面的技术实在是非常强力。

考虑我们如果翻了超过六个面，那么直接报告不是三棱/四棱，翻的次数也是$$O(1)$$的。

-----

于是就结束了，总询问数$$O(\log C)$$。我只能说牛逼!

-----

_jhq给出了一个乱搞做法。我们随一个内部的点，然后随若干个边界上的点，然后爆力查询它们之间哪些是共面的(也就是它们的中点也在边界上)。如果这个几何体很简单，每一个面都很大，那么很可能得到足够的信息来判断。

