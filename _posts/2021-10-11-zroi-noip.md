---
layout: post
title: zroi noip18联测
subtitle: fuck
tags: 课
---

以及两天的杂题选讲（

## Day1

杂题选讲。

-----

CF1427E Xum

牛逼题/jy

直接想法是，随$$10^3$$个倍数插入线性基，但是这个好像不太行。

更随的想法是，直接随$$10^5$$次操作插入线性基，这个好像很可以。

简单做法是，考虑每次消去最高位，于是设$$x$$的位数是$$k$$，你就考虑把$$x$$左移$$k-1$$位使得它的最低位和$$x$$的最高位对齐，记为$$t$$，那么$$y=x\operatorname{xor}t$$就消去了$$x$$的最高位。此时我们把这个数以$$x$$的最高位分成两部分，高一半就是$$t-1$$，而低一半是$$x$$除去最高位。

然后我们给$$y$$再加上$$t$$，低一半不变，高一半变成$$2t-1$$。注意到$$2t$$的$$\mathrm{lowbit}$$必然是$$2$$(忽略后面一车$$0$$)，于是这里必然在$$2$$上造成退位，于是它的$$2$$这一位变成$$0$$而$$1$$这一位变成$$1$$。

考虑$$2t$$，我们计算$$(x+2t)\operatorname{xor}(y+t)$$，$$x+2t$$在$$k,k+1$$位上是$$1,1$$，而$$y+t$$是$$1,0$$。我们得到了一个$$2^{k+1}$$，但是本来打算要$$2^k$$来着¿

没有关系，我们可以用这个把$$t$$中$$>k$$位的$$1$$全都干掉，就得到了$$2^k$$。做完了。

惊悚做法是，考虑裴蜀定理。

发现$$x\operatorname{xor}t$$必然和$$x$$互质，因为$$x\operatorname{xor}t+2^k$$是$$x$$的倍数，而$$2^k$$不是。

所以我们exgcd解出一组$$a,b$$使得$$ax+by=1$$，现在问题是$$a,b$$可能有负数，正数直接做就完了。

考虑钦定$$b$$是负的，那么直接给$$b$$取负，问题变成实现减法。注意到$$ax,by$$是相邻的，于是如果是奇数减偶数就可以直接$$\mathrm{xor}$$，如果是偶数减奇数那我们就都加上$$x$$，就变成奇数减偶数了。

-----

CF1340D Nastya and Time Machine

classic/jy

收录于 CF思维题选胡。

-----

CF1442D Sum

classic/jy

收录于 CF再选做。

-----

CF1446C Xor Tree

建立trie，设$$dp(u)$$表示$$u$$子树最多保留几个点。发现只选一棵子树一定是可以的，如果选了两棵子树，那么其中一棵一定只有一个点，超过一个则会自己连自己，两边就不连通了。

-----

CF1439B Graph Subset Problem

classic/jy

收录于 CF思维题选胡。

-----

洛谷P4007 小Y和恐怖的奴隶主

看起来就直接设$$dp(i,a,b,c)$$表示打了$$i$$下，有$$a,b,c$$个$$1,2,3$$血量的随从概率，$$f(i)$$表示打boss次数的期望，转移是线性变换，状态数大概不到$$500$$，矩阵快速幂即可。多测就预处理幂，矩阵乘向量。

实际上据说状态数是$$166$$(包括$$f$$)/jy

-----

HDU6145 Arithmetic of Bomb II

看起来很有儒略日内味。

考虑我们把每个bomb表达式标准化成左闭右开，也就是左边是数字，右边是运算符。

如果一个bomb表达式两边都是符号，那它就完了。如果两边都是数字，我们可以拆出第一段和最后一段，把中间搞成左闭右开。

然后就可以考虑，如果最后一个是加号那就简简单单；如果最后一个是乘号，如果全是乘号那就直接做，否则就把最前和最后一项拼起来，还是特判开头结尾。做完了。

然后听说是矩阵快速幂/jy

考虑一个牛逼做法，我们维护三元组$$a+bc$$，那么加入一个数字和三种符号都是线性变换，做完了。

-----

Gym100543L Outer space invaders

离离原上谱，区间dp。

考虑设$$dp(i,j)$$表示干掉左右端点都在$$[l,r]$$的敌人的最小代价，那么最远的那个一定要为它开一炮，于是我们可以枚举什么时刻把它干了，就分成两段了。

这还是一个扫描线方向的问题，这个做法就是按距离从上到下扫描线。所以还是不要一上来就咬定自己的扫描线方向。

-----

Gym101480E Export Estimate

扫描线。

注意到所有二度点都会被删掉，会减少一条边。

然后考虑自环不会被删。

并查集维护即可。

-----

Gym101620J Justified Jungle

$$k+1$$必然是$$n$$的因数，所以就枚举一个大力模拟即可。

然后你发现砍了一个点的父边，当且仅当它的子树大小是$$\frac{n}{k+1}$$的倍数，于是做完了。想不到吧，狄利克雷前缀和一下，这是$$O(n\log\log n)$$的/jy

------

Gym101620L Lunar Landscape

垂直于屏幕向外扫描线（

坐标极小，我们直接算每个格子被覆盖多少次(斜边上是0.5次)，两类分别差分-前缀和即可。

哦注意到斜边有四类，所以我们需要给每一类斜边都开一个差分-前缀和，所以是六个/jy

-----

AGC052B Tree Edges XOR

随便找一个点作为根，求一个树上前缀和，那么边权就变成了点权的$$\mathrm{xor}$$。

考虑此时一个操作的效果，发现它就是交换端点的点权。

所以我们直接判断两个集合是否相等，然后就wa飞了。

考虑这个找一个根，相当于钦定了一个点点权是$$0$$，但是后面这个点权可能换走了。所以我们需要枚举那个点权换到哪里去了，或者枚举它可能还被钦定成了什么(这个数一定可以是某个$$d$$)，这就$$n^2$$了。

注意到$$n$$是奇数，所以我们给所有数都$$\mathrm{xor}$$上全局$$\mathrm{xor}$$和，就相当于把它们标准化了，判断是否同构即可。

另一个直接且爆力的想法是，我们直接找到一组点权$$f$$，使得一条边的权值是端点权值的$$\mathrm{xor}$$。为了保证唯一性，由于$$n$$是奇数，我们可以限制总$$\mathrm{xor}$$和是$$0$$。直接分配，然后给每个数$$\mathrm{xor}$$上总$$\mathrm{xor}$$和，判断是否同构即可。

-----

COCI2018-2019 TENIS

有三项属性，一个人可能打败另一个人当且仅当有一维排名更靠前，现在要进行淘汰赛，你每次可以选两个人比赛，支持交换两个人的排名，查询一个人是否可能登顶。$$n,q\leq 10^5$$。

考虑每个人在每个维度上向他可以打败的人连边，然后得到三个竞赛图，缩SCC之后还是形成一条链，第一个SCC就是可能赢的人。问题变成找第一个SCC，这等价于找第一个前缀使得三个排列中这个前缀都是SCC并且重排同构，而你发现一个排列中每个前缀都是SCC，因为这是完全可比并且传递的。所以就是找一个前缀使得三个序列的这个前缀同构。

hash看起来并不可行。

考虑找到每个数第一次出现和最后一次出现，那么这条线就不能被这两次出现跨过，每个数相当于一个区间加，要找第一个$$0$$，线段树即可。

-----

洛谷P5307 COCI2018-2019 Mobitel

离离原上谱。考虑设$$dp(i,j,k)$$表示走到$$i,j$$，再乘一个$$k$$就能超过$$n$$，而$$k$$只有根号种，所以就做完了。

-----

洛谷P7207 COCI2019-2020#3 Sob

¿

考虑法嘛塔优化建图，然后Dinic硬上，有没有可能做完了¿

考虑$$A$$中最大的数$$x$$和哪个匹配，我们爆力找出这个数$$y$$，那么$$x-1,y-1$$也能匹配。然后就做完了。

听起来很奇怪，这是为什么呢?优质解答 : 我不知道

-----

COCI2019-2020 Pastiri

树，有$$k$$个关键点，你要放一些守卫，每个守卫可以守住最近的关键点，如果有多个那么都可以守住，求最少需要多少守卫，构造方案。$$n\leq 5\times 10^5$$。

考虑随便选一个根，然后考虑所有深度最深的关键点，我们一定需要一个守卫去守它，但是它实在是很深所以我们希望这个守卫尽量靠上，所以我们要找到所有能守住这个点的点中最浅的。

然后我们就删掉所有影响了复杂度的点。一开始预处理每个点可以守住哪些关键点，可以多源bfs。

-----

COCI2019-2020 Semafor

有最多两个五段显示器，每个可以显示$$0,...,9$$，接下来你要操作$$n$$次，每$$k$$次之后要求每个显示器显示的都是合法数字，问最后显示出来每个数的方案数。$$n\leq 10^{15}$$。

考虑爆力矩阵快速幂，做完了。

吗?你发现要求每$$k$$个的转移矩阵，复杂度比较高，因为状态数是$$2^{5+5}=1024$$。每$$k$$个之间状态数是$$100$$。

考虑一段之内，两个显示器是独立的，所以我们可以分别算，最后卷起来。这个还是不行。

注意到方案数只跟有多少位变化了有关，所以我们可以直接记录现在需要变$$i$$位的方案数，然后这个也可以矩阵快速幂。这个矩阵大小就只有$$11$$。

-----

AGC043B 123 Triangle

差分还取绝对值，离离原上谱。不过可以注意到这个操作对两个操作数是对称的。

考虑答案只可能是$$0,1,2$$。

考虑如果有$$1$$，那么最后$$1$$会把$$2$$吃掉，于是答案只可能是$$0,1$$。否则，答案就是$$0,2$$。

然后你发现操作变成了$$\mathrm{xor}$$，于是用组合数算出每个数贡献多少次即可。膜$$2$$难以处理逆元，可以使用Lucas定理。

-----

AGC044B Joker

爆力01bfs就是$$n^4$$。如何优化?

不要优化。考虑每个人被算入多少次，那么我们就算他在每个时间走出去的最短路，然后算他到每个人的最短路，还是$$n^4$$。

做法足够厉害。考虑先直接往一个方向冲作为最短路，这样最短路的和是$$O(n^3)$$的，然后用spfa的方法爆力更新，每次更新都会减少总和，所以总次数就是$$O(n^3)$$。

-----

AGC045B 01 Unbalanced

把$$0$$变成$$-1$$，问题变成最小化前缀和的极差。

枚举最大值，然后我们能填$$1$$就填$$1$$，这样会让最小前缀和尽可能小。复杂度是$$O(n^2)$$。

结论是，把所有$$?$$当成$$-1$$，然后求最大前缀和$$s$$，那么只需要检查$$s$$和$$s+1$$。因为有一个$$-1$$变成了$$1$$的话，如果最小前缀和在此之前它不会变，否则它也只能变大$$2$$，因此一定不更优。

-----

AGC045C Range Set

考虑怎么判断一个串是否可行。时间倒流，变成你可以把连续$$a$$个$$0$$或者$$b$$个$$1$$变成任意串。

不妨设$$a>b$$，于是如果有连续$$a$$个$$0$$就一定可行，否则考虑如果有连续$$b$$个$$1$$，那么我们把它全变成$$0$$，然后剩下了连续$$a$$个$$0$$就可行。

考虑dp，设$$dp(i,j,0/1)$$表示填了$$i$$位，换完$$1$$连续段之后最后有连续$$j$$个$$0$$，这一位是$$0/1$$的方案数。

 - 如果在填黑色，我们枚举上一个白色的位置，可以前缀和优化

 - 如果在填白色，我们枚举上一个黑色的位置，还是可以前缀和优化

然后就做完了。复杂度是$$O(n^2)$$。

-----

CF1458C Latin Square

足够厉害。收录于 CF再选做。

-----

CF1361E James and the Chase

看到占比，考虑随机化，我们随$$100$$次，然后判断一个点是不是好点。

考虑如果找到了一个好点，怎么才能找到所有好点。建立dfs树，那么因为根是好点，不可能有横向边，于是好点的子树内只有恰好一条返祖边，并且这条边连向另一个好点。复杂度$$O(kn)$$，$$k$$是常数$$100$$。

哦，考虑怎么找好点，那就是有横向边就不是好点，否则就是好点。

-----

CF1444D Rectangular Polyline

先判掉$$h\neq v$$，然后背包背一个一半。

考虑直接构造，我们已经分成了两半，每一半让横着的从小到大排，竖着的从大到小排，这样就可以尽可能远离了。

容易证明这样做一定不会越过对角线，于是不会在顶点之外的地方相交。