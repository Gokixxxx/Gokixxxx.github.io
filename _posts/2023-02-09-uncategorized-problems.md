---
layout: post
title: 未归类问题
subtitle: /kk
tags: 问题集
---

标题五个字/cf

-----

spoj CARD - Cardsharper

来自fajne zadania。

考虑每个元素会如何移动。在$a$上沿着一个环走，在$b$上同样沿着一个环走。

我们想起来一个经典问题，好像来自atc，说的是如果你能够转整个序列，或者转前三个元素，就可以排序。显然还有很多类似的东西。猜测我们总是可以生成绝大多数的排列。

考虑能不能把$a$变成一个简单一点的东西。我们尝试把它变成一个环。如果$a$中能找到一个环，满足剩下的环长度都和它的长度互素，那么我们取剩下的环长度的$\mathrm{lcm}$次幂就赢了。当然如果这个环长度是$1$则不行。这个条件还是很难满足。

考虑

-----

cf1578l

这个题是牛逼老哥给我看的啊。

跑个mst先。二分答案先。

时间倒流。然后在kru重构树上往上走即可。

于是也不需要二分答案了。

-----

agc061a

先打表。观察小的感觉偶数的形式很好，这里给出16~30的偶数。

```
16
2 1 4 3 6 5 8 7 10 9 12 11 14 13 16 15 
18
2 1 3 4 5 6 7 8 9 10 11 12 13 14 15 16 18 17 
20
2 1(4 3)5 6 7 8 9 10 11 12 13 14 15 16 18 17 20 19 
22
2 1 3 4(6 5)7 8 9 10 11 12 13 14 15 16 18 17 19 20 22 21  
24
2 1(4 3)(6 5)(8 7)9 10 11 12 13 14 15 16 18 17 20 19 22 21 24 23 
26
2 1 3 4 5 6 7 8(10 9)11 12 13 14 15 16 18 17 19 20 21 22 23 24 26 25 
28
2 1(4 3)5 6 7 8(10 9)(12 11)13 14 15 16 18 17 20 19 21 22 23 24 26 25 28 27 
30
2 1 3 4(6 5)7 8(10 9)11 12(14 13)15 16 18 17 19 20 22 21 23 24 26 25 27 28 30 29 

```

可以注意到只可能是每对$2i-1,2i$交换，这是因为$\mathrm{shuffle}(1,n)=\mathrm{shuffle}(1,n-2),\mathrm{shuffle}(2,n-1),\mathrm{shuffle}(2,n-1),\mathrm{shuffle}(3,n)$，中间抵消了，然后归纳即可。括号标记的是除$n=16$之外，左半边非两头的交换了的位置。

$\mathrm{shuffle}(1,n-2),\mathrm{shuffle}(3,n)$，实际上就是把自己和自己平移一位之后每两个内部是否交换的状态$\operatorname{xor}$一下。于是我们看看$x\leftarrow x\operatorname{xor}(x\operatorname{shift}1)$是什么，把$\operatorname{xor}$看成加法膜$2$我们知道它是$F\leftarrow (1+z)F$，于是当我们想要一个位置的时候，提取出来是一个二项式系数膜$2$，可以用lucas定理算出它那里换没换。如果$n$是偶数那么做完了，如果$n$是奇数那么递归一层即可。

-----

cf717a

求$\sum\limits_{i=l}^r\binom{f_i}{k}$，其中$f$是fib数。

看起来很是不好做。考虑下降幂转普通幂，我们算$\sum\limits_{i=l}^rf_i^k$。尝试塞通项$c(a^n+b^n)$然后二项式定理，它就是$\sum\limits_{j=0}^k\binom{k}{j}\sum\limits_{i=l}^r(a^jb^{k-j})^i=\sum\limits_{j=0}^k\binom{k}{j}\frac{(a^jb^{k-j})^l-(a^jb^{k-j})^{r+1}}{1-a^jb^{k-j}}$，这里需要特判$a^jb^{k-j}=1$的情况。复杂度$O(k^2\log v)$，可以预处理一些东西然后线性求逆做到$O(k^2)$。

洛谷讨论区的题

$f$是$a,b$-fib数，也就是$f_i=af_{i-1}+bf_{i-2}$。

那么问题就是怎么求通项了。$F=azF+bz^2F+f_0+z(f_1-f_0)$，设后面是$p+zq$，那么$F=\frac{p+zq}{1-az-bz^2}$。那么我们知道上面的$a,b$这里就是$1-az-bz^2$的两个根，剩下的东西就乱算一通!

-----

cco2020 Shopping Plans

从xxiii poi stage 1 korale过来的。

首先每种买上最小的$x_j$个。然后第$k$小的钱数$d$，尝试搜出所有方案，我们要调整当前这个颜色到任意一个方案，可以通过在最右一个右边加入一个，或者把一个连续的后缀右移一位。

那么需要保证不能有重复的方案。为了做到这一点，考虑我们依次处理每个种类，也就是可以选择这个颜色的两种操作，或者移动到下一个颜色。我们需要保证移动到下一个颜色时能操作，所以按$2$和$1$位的差从大到小排，二分出可以到哪个后缀去。复杂度$O(n\log^2 n)$。

然后这东西也适用于那个扩展的想法，并且这样我们只需要二分$k$次。复杂度$O(n\log n)$。

-----

loj6500 雅礼集训18 D2 操作

牛逼群友给我看的。

考虑最左边那个数，它确定了最左边的区间是不是需要操作，如此往右递推就是$O(nm)$。

注意到如果我们操作了$[l,l+k)$之后其中还有$1$，必然继续操作下去，但是这个复合有点困难。

还是考虑差分吧!那么操作就是把$s_i,s_{i+k}$同时$\operatorname{xor}$上$1$。于是每个膜$k$等价类中的$1$需要两两配对，答案就是这个距离和，那么处理每个等价类中奇数位置和偶数位置的前缀和，查询的时候差分一下扫描线扫过去就好了。还需要判断是否可行，也就是两边在各等价类状态的奇偶性是否相同，hash一下即可。

-----

loj6736 最小连通块

这个题有一个牛逼做法啊。考虑我们可以$O(c(1+\log\frac{n}{c}))$地在$n$个点的树中找到一棵大小为$c$的子树中的所有点，然后随机一个根和一个点，得到的子树大小期望是$<\frac{n}{2}$的，所以就$O(n\log n)$了。

-----

tjoi2017 城市

有趣题。首先我们必然断直径上的一条边，然后我们会连两边的直径中点，那么问题是怎么求两边的直径中点，随便取一个直径端点为根做一边的，考虑直径中点总是在到任何一个点距离最大的点上，那么dp求出直径长度，长链剖分，从重儿子到父亲直径端点会沿长链向上shift若干步，总移动量是线性。

-----

cf1776G

虽然反对出这种题，但是还是很厉害!

-----

An Optimal Algorithm for Calculating the Profit in the Coins in a Row Game

pa2010 Termites/hnoi2010 取石头游戏

题意是若干个序列，每个序列可能有一个位置是根或者没有。两个人每次选一个序列，取走一端，如果是根则只能最后取走，都希望自己获得的总和尽可能大。求结果。

显然每个人选的个数是确定的。

翻译一下论文。

定义一个策略是状态到选择的映射。定义$\operatorname{val}(a,b)$是A采用策略$a$，B采用策略$b$得到的结果。

如果A固定使用策略$a$，那么结果就是$\min\limits_b\operatorname{val}(a,b)$。为了证明$a_1$不比$a_2$优，我们可以对于每个$b_2$，找到一个$b_1$使得结果不会更大。

设最大值是$m$。

**引理1** 如果某个$m$可以选，那么必然选它。

**证明** 归纳。如果A没有选，而是选了某个序列的某一端$t$，那么根据归纳假设B选了。考虑使用上面那个方法，取$a_1$是任意没有选$m$的策略，$a_2$是类似但先选了$m$的策略，$b_2$是任意策略，$b_1$是没有选$m$的策略，具体一点，使得$a_1,b_1$中第$2k$步的区别和$a_2,b_2$中第$2k-1$步的区别就是A在$t$这边多选了一个，且$m$被B而不是A选了。

如果何时$b_2$在$t$上选了一个，$b_1$就没法跟着走了，但是注意到此时剩下的局面是相同的。

现在$m$不能选。那么它两边都有数，设为$x,y$，根据前一个结论，一个人选了$x$或$y$，另一个人必然选$m$，那么由于他甚至不得不把$m$让出去，猜测他必然还会继续选$x,y$中剩下的一个，所以我们把三个合并成一个数$x+y-m$。

**定理1** 如果某个$m$两侧分别是$x,y$，那么可以把它三个合并成$x+y-m$。