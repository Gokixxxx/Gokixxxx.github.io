---
layout: post
title: 集合幂级数
subtitle: 草?
tags: 数学 生成函数
---

### 集合占位幂级数

对于一个集合幂级数$$F(x)$$，它的集合占位幂级数$$P(F)$$定义为 : 把它的每一项$$f_Sx^S$$换成一个多项式$$P(f)_S(z)=f_Sx^Sz^{\vert S\vert}$$，换句话说加一个形式变量$$z$$来记录大小。

### 子集卷积

容易发现集合占位幂级数并卷积之后取所有$$x^Sz^{\vert S\vert}$$项就对应子集卷积，解释一下就是利用大小判断是不是不交并。

具体一点，我们把加法换成多项式加法做一遍法嘛塔，然后把乘法换成爆力多项式乘法做一遍点乘，然后做一遍逆法嘛塔。复杂度$$O(2^nn^2)$$。

### ln-exp

子集卷积下的exp的组合意义还是很好解释!也就是每个集合$$S$$有$$f_S$$中染色方案，$$\exp f_S$$就是选取若干不相交集合无序地组成$$S$$并染色的方案数。$$\ln$$当然是这个的逆。

计算这个很好说，我们把子集卷积里面的多项式乘法换成$$\exp$$就好了。计算$$\ln$$就换成$$\ln$$。为什么是对的可以感性理解。~~(wls: 性感理解)~~

### 例题

就一道，我是为着这个来学的（

GP of Zhejiang F. Fast as Ryser

给简单图和常数$$c$$，定义一个大小为$$k$$的匹配权值是$$c^k$$，求所有匹配权值和。$$n\leq 36$$。

这里没法用点独立集的做法，因为边数太**多了，直接上复杂度又不是很好。

300iq看到这题时，认为它是2020年最棒的题。我们干一件非常妙的事情 : 往$$2i-1$$和$$2i$$之间连边。每一条这样的边连接的点，我们称为一个 点对。

你发现匹配加上这样的边，会变成若干不交的环和链，这样东西的数量不超过$$\frac{n}{2}$$，最大是$$18$$...!

然后考虑我们对于每个集合计算它里面构成一条链或者一个环的方案数，然后做一个子集$$\exp$$。

怎么算这个呢?考虑状压dp。

对于一条链，我们设$$dp(S,i)$$表示$$S$$中的点构成一条链，最后一个点是$$i$$的方案数，那么转移显然，复杂度是$$O(2^\frac{n}{2}n^2)$$。

对于一个环，直接跟链一样做就行了。

然后就做完了。复杂度$$O(2^\frac{n}{2}n^2)$$。